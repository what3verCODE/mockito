fileGroups:
  sources:
    - 'src/**/*'
    - 'Cargo.toml'
    - 'Cargo.lock'
  tests:
    # Tests are in the same files as code (in #[cfg(test)] modules)
    - 'src/**/*'

tasks:
  build:
    command: 'cargo build'
    inputs:
      - '@globs(sources)'
    outputs:
      - 'target/debug/**/*'
    local: true

  build-release:
    command: 'cargo build --release'
    inputs:
      - '@globs(sources)'
    outputs:
      - 'target/release/**/*'
    local: true
    
  check:
    command: 'cargo check'
    inputs:
      - '@globs(sources)'

  test:
    command: 'cargo test --all-features'
    inputs:
      - '@globs(sources)'
      - '@globs(tests)'

  fmt:
    command: 'cargo fmt --all --check'
    inputs:
      - '@globs(sources)'
      - '@globs(tests)'

  fmt-write:
    command: 'cargo fmt --all'
    inputs:
      - '@globs(sources)'
      - '@globs(tests)'
    local: true

  lint:
    command: 'cargo clippy --all-features -- -D warnings'
    inputs:
      - '@globs(sources)'
      - '@globs(tests)'

  lint-fix:
    command: 'cargo clippy --fix --all-features'
    inputs:
      - '@globs(sources)'
      - '@globs(tests)'
    local: true

  coverage:
    command: 'cargo tarpaulin --out stdout'
    inputs:
      - '@globs(sources)'
      - '@globs(tests)'

  clean:
    command: 'cargo clean'
    local: true